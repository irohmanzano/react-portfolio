import { Dispatch, SetStateAction, useEffect } from 'react';
import { AnimatePresence, motion } from "motion/react";
import Modal from "./Modal";

function ProjectCard({title, desc, itemNo, images, topM, gitLink, modalData, setModalData, techStack, isVisible, setIsVisible}: {title: string, desc: string, itemNo: string, images: string[], topM: string, gitLink: string, modalData: ModalData, setModalData: Dispatch<SetStateAction<ModalData>>, techStack: string[], isVisible: boolean, setIsVisible: Dispatch<SetStateAction<boolean>>}) {
    const folderName = title.includes(' ') ? title.split(' ').join('_') : title;
    const descSplit = desc.split(' ').slice(0, 20).join(' ') + '..';
    const parentAnim = {
        rest: {
            borderRadius: '0'
        },
        hover: {
            borderRadius: '4rem',
            transition: {
                duratiom: 0.1
            }
        }
    }
    const childAnim = {
        rest: {
            scale: 1
        },
        hover: {
            scale: 1.2,
            transition: {
                duration: 0.5,
                ease: 'easeOut'
            }
        }
    }

    const buttonAnimTop = {
        rest: {
            top: '-36px'
        },
        hover: {
            top: 0,
            transition: {
                duration: 0.3,
                ease: 'easeOut'
            }
        }
    }

    const buttonAnimBottom = {
        rest: {
            top: 0
        },
        hover: {
            top: '36px',
            transition: {
                duration: 0.3,
                ease: 'easeOut'
            }
        }
    }

    useEffect( () => {
        if(isVisible) {
            document.body.style.overflow = 'hidden';
        }
        else {
            document.body.style.overflow = 'unset';
        }

        return () => {
            document.body.style.overflow = 'unset'
        }
    }, [isVisible]);

  return (
    <>
        <motion.div
            className="bg-white mx-6 md:sticky border-t-2"
            style={{
                top: `${topM}vh`
            }}

            initial={{
                marginLeft: '-100vw'
            }}

            whileInView={{
                marginLeft:  '1.5rem'
            }}

            transition={{
                delay: 0.1,
                ease: 'easeOut'
            }}

            viewport={{
                once: true
            }}

            onClick={() => {
                setModalData(prev => ({
                    ...prev,
                    title: title,
                    images: images,
                    desc: desc,
                    techStack: techStack,
                    gitLink: gitLink
                }));
                setIsVisible(prev => !prev);
            }}
        >
            <motion.div
                className='flex md:flex-row flex-col h-fit py-8 md:px-32 bg-slate-950 cursor-pointer'
                style={{
                    top: `${topM}vh`, 
                }}
                variants={parentAnim}
                initial= 'rest'
                whileHover='hover'
            >   
                <div
                    className="mr-4 w-56 self-center overflow-hidden min-w-10"
                >
                    <motion.img
                        src={`/${folderName}/1.jpg`}
                        alt="thumbnail" 
                        variants={childAnim}
                    />
                </div>
            <p className="mr-24 text-xl text-red-500">{itemNo}</p>
            <div
                className="md:pr-20 flex-1 justify-between flex flex-col md:items-start items-center md:text-left text-justify"
            >
                <div>
                    <h1
                        className="mb-8 text-3xl md:text-left text-center"
                    >
                        {title}
                    </h1>
                    <p className="text-slate-500 md:w-3/4">{descSplit}</p>
                </div>
                <div
                    className="flex items-center gap-2 mb-6 md:mb-0 mt-4"
                >
                    {techStack.includes('m') && <svg className="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="none" viewBox="0 0 24 24">
                    <path fill="currentColor" fillRule="evenodd" d="M7.29395 11.8039c0-3.96638 2.13959-6.41723 3.53335-8.01378.6733-.7712 1.1725-1.34306 1.1725-1.79012 0 .44706.4993 1.01892 1.1725 1.79013 1.3938 1.59654 3.5334 4.04739 3.5334 8.01377 0 4.3266-2.7501 6.9507-4.0764 7.7654L12.3701 22h-.7071l-.2906-2.4295c-1.3255-.8132-4.07845-3.4378-4.07845-7.7666Zm4.06395 6.7007.6419-9.44578.649 9.44578-.649.7503-.6419-.7503Z" clipRule="evenodd"/>
                    </svg>}

                    {techStack.includes('e') &&  <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 48 48">
                    <path fill="white" d="M23.697,37.56h1.18c0.84,0,1.631-0.392,2.139-1.061l7.485-9.847l7.485,9.847	c0.508,0.668,1.299,1.061,2.139,1.061h1.18L35.756,25l9.121-12h-1.18c-0.84,0-1.631,0.392-2.139,1.061L34.5,23.347l-7.059-9.287	C26.933,13.392,26.142,13,25.302,13h-1.18l9.121,12L23.697,37.56z"></path><path fill="white" d="M24,26v-3c0-6.675-5.945-11.961-12.829-10.852C5.812,13.011,2,17.857,2,23.284L2,24v2v0.142	c0,6.553,4.777,11.786,10.868,11.858c5.092,0.06,9.389-3.344,10.707-7.999h-1.028c-0.62,0-1.182,0.355-1.451,0.913	c-1.739,3.595-5.789,5.862-10.228,4.842C6.776,34.815,4,30.981,4,26.783V26H24z M4,23.71c0-4.708,2.804-8.557,6.924-9.478	C16.798,12.92,22,17.352,22,23v1H4V23.71z"></path>
                    </svg>}

                    {techStack.includes('r') && <svg className="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M21.718 12c0-1.429-1.339-2.681-3.467-3.5.029-.18.077-.37.1-.545.217-2.058-.273-3.543-1.379-4.182-1.235-.714-2.983-.186-4.751 1.239C10.45 3.589 8.7 3.061 7.468 3.773c-1.107.639-1.6 2.124-1.379 4.182.018.175.067.365.095.545-2.127.819-3.466 2.071-3.466 3.5 0 1.429 1.339 2.681 3.466 3.5-.028.18-.077.37-.095.545-.218 2.058.272 3.543 1.379 4.182.376.213.803.322 1.235.316a5.987 5.987 0 0 0 3.514-1.56 5.992 5.992 0 0 0 3.515 1.56 2.44 2.44 0 0 0 1.236-.316c1.106-.639 1.6-2.124 1.379-4.182-.019-.175-.067-.365-.1-.545 2.132-.819 3.471-2.071 3.471-3.5Zm-6.01-7.548a1.5 1.5 0 0 1 .76.187c.733.424 1.055 1.593.884 3.212-.012.106-.043.222-.058.33-.841-.243-1.7-.418-2.57-.523a16.165 16.165 0 0 0-1.747-1.972 4.9 4.9 0 0 1 2.731-1.234Zm-7.917 8.781c.172.34.335.68.529 1.017.194.337.395.656.6.969a14.09 14.09 0 0 1-1.607-.376 14.38 14.38 0 0 1 .478-1.61Zm-.479-4.076a14.085 14.085 0 0 1 1.607-.376c-.205.313-.405.634-.6.969-.195.335-.357.677-.529 1.017-.19-.527-.35-1.064-.478-1.61ZM8.3 12a19.32 19.32 0 0 1 .888-1.75c.33-.568.69-1.118 1.076-1.65.619-.061 1.27-.1 1.954-.1.684 0 1.333.035 1.952.1a19.63 19.63 0 0 1 1.079 1.654c.325.567.621 1.15.887 1.746a18.869 18.869 0 0 1-1.953 3.403 19.218 19.218 0 0 1-3.931 0 20.169 20.169 0 0 1-1.066-1.653A19.324 19.324 0 0 1 8.3 12Zm7.816 2.25c.2-.337.358-.677.53-1.017.191.527.35 1.065.478 1.611a14.48 14.48 0 0 1-1.607.376c.202-.314.404-.635.597-.97h.002Zm.53-3.483c-.172-.34-.335-.68-.53-1.017a20.214 20.214 0 0 0-.6-.97c.542.095 1.078.22 1.606.376a14.111 14.111 0 0 1-.478 1.611h.002ZM12.217 6.34c.4.375.777.773 1.13 1.193-.37-.02-.746-.033-1.129-.033s-.76.013-1.131.033c.353-.42.73-.817 1.13-1.193Zm-4.249-1.7a1.5 1.5 0 0 1 .76-.187 4.9 4.9 0 0 1 2.729 1.233A16.253 16.253 0 0 0 9.71 7.658c-.87.105-1.728.28-2.569.524-.015-.109-.047-.225-.058-.331-.171-1.619.151-2.787.885-3.211ZM3.718 12c0-.9.974-1.83 2.645-2.506.218.857.504 1.695.856 2.506-.352.811-.638 1.65-.856 2.506C4.692 13.83 3.718 12.9 3.718 12Zm4.25 7.361c-.734-.423-1.056-1.593-.885-3.212.011-.106.043-.222.058-.331.84.243 1.697.418 2.564.524a16.37 16.37 0 0 0 1.757 1.982c-1.421 1.109-2.714 1.488-3.494 1.037Zm3.11-2.895c.374.021.753.034 1.14.034.387 0 .765-.013 1.139-.034a14.4 14.4 0 0 1-1.14 1.215 14.248 14.248 0 0 1-1.139-1.215Zm5.39 2.895c-.782.451-2.075.072-3.5-1.038a16.248 16.248 0 0 0 1.757-1.981 16.41 16.41 0 0 0 2.565-.523c.015.108.046.224.058.33.175 1.619-.148 2.789-.88 3.212Zm1.6-4.854A16.563 16.563 0 0 0 17.216 12c.352-.812.638-1.65.856-2.507 1.671.677 2.646 1.607 2.646 2.507 0 .9-.975 1.83-2.646 2.507h-.004Z"/>
                    <path d="M12.215 13.773a1.792 1.792 0 1 0-1.786-1.8v.006a1.787 1.787 0 0 0 1.786 1.794Z"/>
                    </svg>}
                    
                    {techStack.includes('n') && <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="36" height="36" viewBox="0,0,256,256">
                    <g fill="none" fillRule="nonzero" stroke="none" strokeWidth="1" strokeLinecap="butt" strokeLinejoin="miter" strokeMiterlimit="10" strokeDasharray="" strokeDashoffset="0"><g transform="scale(5.33333,5.33333)"><path d="M17.204,19.122l-4.907,2.715c-0.184,0.101 -0.297,0.289 -0.297,0.492v5.433c0,0.203 0.113,0.39 0.297,0.492l4.908,2.717c0.183,0.101 0.41,0.101 0.593,0l4.907,-2.717c0.182,-0.102 0.295,-0.289 0.295,-0.492v-5.433c0,-0.203 -0.113,-0.39 -0.297,-0.492l-4.906,-2.715c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.103,0 -0.205,0.025 -0.297,0.076M42.451,24.013l-0.818,0.452c-0.031,0.017 -0.049,0.048 -0.049,0.082v0.906c0,0.034 0.019,0.065 0.049,0.082l0.818,0.453c0.031,0.017 0.068,0.017 0.099,0l0.818,-0.453c0.03,-0.017 0.049,-0.048 0.049,-0.082v-0.906c0,-0.034 -0.019,-0.065 -0.05,-0.082l-0.818,-0.452c-0.015,-0.009 -0.032,-0.013 -0.049,-0.013c-0.017,0 -0.034,0.004 -0.049,0.013" fill="#388e3c"></path><path d="M35.751,13.364l-2.389,-1.333c-0.075,-0.042 -0.167,-0.041 -0.241,0.003c-0.074,0.044 -0.12,0.123 -0.12,0.209l-0.001,8.052l-2.203,-1.219c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.102,0 -0.205,0.025 -0.297,0.076h0.001l-4.907,2.715c-0.184,0.101 -0.297,0.289 -0.297,0.491v5.433c0,0.203 0.113,0.39 0.297,0.492l4.908,2.717c0.183,0.101 0.41,0.101 0.593,0l4.907,-2.717c0.182,-0.101 0.295,-0.289 0.295,-0.492v-13.927c0,-0.176 -0.096,-0.338 -0.249,-0.424zM32.866,26.458l-2.23,1.235c-0.083,0.046 -0.186,0.046 -0.269,0l-2.231,-1.235c-0.085,-0.046 -0.136,-0.132 -0.136,-0.224v-2.47c0,-0.092 0.051,-0.177 0.135,-0.224l2.231,-1.234h-0.001c0.042,-0.023 0.088,-0.034 0.135,-0.034c0.047,0 0.093,0.012 0.135,0.034l2.23,1.234c0.084,0.047 0.135,0.133 0.135,0.225v2.47c0,0.091 -0.051,0.177 -0.134,0.223z" fill="#ffffff"></path><path d="M17.204,19.122l-5.204,8.64c0,0.203 0.113,0.39 0.297,0.492l4.908,2.717c0.183,0.101 0.41,0.101 0.593,0l5.202,-8.642c0,-0.203 -0.113,-0.39 -0.297,-0.492l-4.906,-2.715c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.103,0 -0.205,0.025 -0.297,0.076" fill="#2e7d32"></path><path d="M17.204,19.122l-4.907,2.715c-0.184,0.101 -0.297,0.289 -0.297,0.492l5.204,8.642c0.183,0.101 0.41,0.101 0.593,0l4.907,-2.717c0.183,-0.102 0.296,-0.289 0.296,-0.492l-5.203,-8.64c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.103,0 -0.205,0.025 -0.297,0.076" fill="#4caf50"></path><path d="M47.703,21.791l-4.906,-2.715c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.102,0 -0.205,0.025 -0.297,0.076h0.001l-4.907,2.715c-0.183,0.101 -0.297,0.293 -0.297,0.503v5.411c0,0.209 0.114,0.402 0.297,0.503l4.908,2.717c0.184,0.102 0.409,0.102 0.593,0l2.263,-1.253c0.207,-0.115 0.206,-0.412 -0.002,-0.526l-4.924,-2.687c-0.083,-0.047 -0.135,-0.134 -0.135,-0.228v-2.466c0,-0.092 0.05,-0.177 0.13,-0.221l2.235,-1.236h-0.001c0.042,-0.023 0.088,-0.034 0.135,-0.034c0.047,0 0.093,0.012 0.135,0.034l2.235,1.237c0.08,0.044 0.13,0.129 0.13,0.221v2.012c0,0.086 0.046,0.166 0.121,0.209c0.075,0.042 0.167,0.042 0.242,-0.001l2.398,-1.393c0.148,-0.086 0.24,-0.245 0.24,-0.417v-1.88c0,-0.211 -0.114,-0.404 -0.297,-0.505zM10.703,21.791l-4.906,-2.715c-0.092,-0.051 -0.195,-0.076 -0.297,-0.076c-0.102,0 -0.205,0.025 -0.297,0.076h0.001l-4.907,2.715c-0.183,0.101 -0.297,0.293 -0.297,0.503v7.465c0,0.086 0.046,0.166 0.121,0.209c0.075,0.042 0.167,0.042 0.242,-0.001l2.398,-1.393c0.148,-0.086 0.239,-0.245 0.239,-0.417v-4.393c0,-0.092 0.05,-0.177 0.13,-0.221l2.235,-1.236v0c0.042,-0.023 0.088,-0.034 0.135,-0.034c0.047,0 0.093,0.012 0.135,0.034l2.235,1.237c0.08,0.044 0.13,0.129 0.13,0.221v4.393c0,0.172 0.091,0.331 0.24,0.417l2.398,1.393c0.075,0.043 0.167,0.043 0.242,0.001c0.074,-0.044 0.12,-0.124 0.12,-0.21v-7.464c0,-0.21 -0.114,-0.403 -0.297,-0.504z" fill="#ffffff"></path></g></g>
                    </svg>}

                </div>
            </div>
            <button
                className="md:self-end shrink-0 self-center w-36 h-9 text-xs relative bg-white overflow-hidden"
                style={{
                    fontFamily: "Roboto, serif"
                }}
                onClick={() => {
                    setModalData(prev => ({
                        ...prev,
                        title: title,
                        images: images,
                        desc: desc,
                        techStack: techStack,
                        gitLink: gitLink
                    }));
                    setIsVisible(prev => prev)
                }}
            >
                <motion.div
                    className="h-9 px-6 py-2 w-36 absolute text-black"
                    style={{backgroundColor: 'yellow'}}
                    variants={buttonAnimTop}
                >
                    VIEW DETAILS
                </motion.div>
                <motion.div
                    className="px-6 py-2 h-9 bg-red-500 w-36 absolute top-0"
                    variants={buttonAnimBottom}
                >
                    VIEW DETAILS
                </motion.div>
            </button>
            </motion.div>
        </motion.div>
        <AnimatePresence>
            {isVisible && <Modal modalData={modalData} />}
        </AnimatePresence>
    </>
  )
}

export default ProjectCard